@startuml
' Syntax verified: 2025-10-30
' C4 Level 3: Component Diagram - Web Application

title C4 Level 3 Component Diagram - Web Application Components

skinparam component {
    BackgroundColor<<presentation>> #85BBF0
    BackgroundColor<<business>> #85BBF0
    BackgroundColor<<data>> #85BBF0
    BackgroundColor<<external>> #999999
    FontColor black
}

skinparam database {
    BackgroundColor #999999
    FontColor white
}

package "Web Application [ASP.NET MVC 4 Container]" {

    package "Presentation Layer" {
        component [Home Controller] as home <<presentation>>
        component [SiteLayout Controller] as layout <<presentation>>
        component [Error Controller] as error <<presentation>>
        component [Razor Views] as views <<presentation>>
        component [View Models] as viewmodels <<presentation>>
    }

    package "Business Logic Layer" {
        component [Category Manager] as catmgr <<business>>
        component [Product Manager] as prodmgr <<business>>
    }

    package "Data Access Layer" {
        component [Common] as common <<data>>
        component [CYCLE_STORE\nEntities] as context <<data>>
        component [Entity Models] as entities <<data>>
    }
}

database "CYCLE_STORE\nDatabase" as db <<external>>

home --> views : Renders
layout --> views : Renders
layout --> catmgr : Calls static methods
layout --> viewmodels : Populates
error --> views : Renders

catmgr --> common : Accesses\nDataEntities
prodmgr --> common : Accesses\nDataEntities
common --> context : Returns new\ninstance
context --> entities : Exposes as\nDbSets

context --> db : Queries via\nEntity Framework\n[LINQ to SQL]

note right of home
  **File**: HomeController.cs
  **Namespace**: AdventureWorks.Controllers
  **Actions**: Default()
  **Status**: Minimal implementation
end note

note right of catmgr
  **File**: CategoryManager.cs
  **Namespace**: AdventureWorks.Business
  **Pattern**: Static utility class
  **Data Access**: Common.DataEntities
end note

note right of prodmgr
  **File**: ProductManager.cs
  **Namespace**: EpicAdventureWorks
  **WARNING**: Inconsistent namespace
  **Pattern**: Static utility class
  **Mixed Access**: Uses both
  Products and Product
end note

note right of common
  **File**: Common.cs
  **Pattern**: Static Factory
  **Anti-pattern**: Creates new
  DbContext per property access
end note

note right of context
  **File**: CycleModel.Context.cs
  **Generated**: Entity Framework T4
  **Connection**: CYCLE_STOREEntities
  **Database-First**: EDMX model
end note

@enduml
