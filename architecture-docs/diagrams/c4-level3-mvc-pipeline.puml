@startuml
' Syntax verified: 2025-10-30
' C4 Level 3: MVC Request Pipeline Components

title C4 Level 3 MVC Request Pipeline Components

skinparam component {
    BackgroundColor<<pipeline>> #85BBF0
    BackgroundColor<<auth>> #85BBF0
    BackgroundColor<<mvc>> #85BBF0
    BackgroundColor<<external>> #999999
    FontColor black
}

skinparam database {
    BackgroundColor #999999
    FontColor white
}

package "Web Application [ASP.NET MVC 4 Container]" {

    package "HTTP Pipeline" {
        component [Global.asax] as global <<pipeline>>
        component [Route Config] as route <<pipeline>>
        component [Filter Config] as filter <<pipeline>>
        component [Web API Config] as api <<pipeline>>
    }

    package "Authentication & Security" {
        component [Forms Authentication\nModule] as forms <<auth>>
        component [HandleError\nAttribute] as errorfilter <<auth>>
    }

    package "MVC Controllers" {
        component [Controller\nFactory] as factory <<mvc>>
        component [Action Invoker] as invoker <<mvc>>
        component [View Engine] as viewengine <<mvc>>
    }
}

component [SQL Membership\nProvider] as membership <<external>>
database "ASPNetDB" as memberdb <<external>>

global --> route : Registers\non startup
global --> filter : Registers\non startup
global --> api : Registers\n(unused)

route --> factory : Routes request\nto controller
filter --> errorfilter : Adds to\nfilter pipeline

forms --> membership : Validates\ncredentials
membership --> memberdb : Queries user\ndata

factory --> invoker : Creates controller\nand invokes action
invoker --> errorfilter : Executes through\nfilter pipeline
invoker --> viewengine : Returns view\nresult

note right of global
  **File**: Global.asax.cs
  **Method**: Application_Start()
  **Registers**:
  - AreaRegistration
  - WebApiConfig
  - FilterConfig
  - RouteConfig
end note

note right of route
  **File**: RouteConfig.cs
  **Default Route**:
  {controller}/{action}/{id}
  **Defaults**:
  controller = "Home"
  action = "Default"
end note

note right of forms
  **Configuration**: Web.config
  **Cookie**: ADVENTUREWORKS.AUTH
  **Login URL**: ~/Home/Login
  **Timeout**: 30 days
  **Sliding Expiration**: true
  **Protection**: Encryption + Validation
end note

note right of membership
  **Provider**: SqlMembershipProvider
  **Connection**: ASPNetDB
  **Status**: MISCONFIGURATION
  Connection string not defined
  **Password Format**: Hashed
  **Min Password Length**: 1
end note

note right of errorfilter
  **Configuration**: FilterConfig.cs
  **Registered Globally**: Yes
  **Custom Error Pages**:
  - 404 -> ~/Error
  - 500 -> ~/Error
end note

note left of api
  **Status**: CONFIGURED BUT UNUSED
  No ApiController classes found
  Route template defined but
  no endpoints implemented
end note

@enduml
